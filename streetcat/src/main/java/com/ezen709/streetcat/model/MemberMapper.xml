<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen709.streetcat.model">

	<select id="listMember"   resultType="memberDTO">
		select * from cat_user  
	</select>
	
	<select id="findMember"	resultType="memberDTO" parameterType="java.util.Map">
		${sql}
	</select>
	
	<select id="getMember" resultType="memberDTO" parameterType="int">
		select * from cat_user where unum = #{unum}
	</select>

	<update id="upgradeMember" parameterType="int">
		update cat_user set grade = #{grade} where unum= #{unum}
	</update>
	
	<delete id="deleteMember" parameterType="int">
		delete cat_user where unum= #{unum}
	</delete>
	

	
	<select id="idCheck" resultType="int">
		<![CDATA[
			SELECT count(*) FROM cat_user
			WHERE userId = #{userId}
		]]>
	</select>
	
	<insert id="signUp">
		<![CDATA[
			insert into cat_user values (seq_unum.nextval, 
			#{name}, #{userId}, #{passwd}, #{email}, sysdate, 0)
		]]>
	</insert>


<!-- 수정중 -->

    <!-- 아이디 찾기 관련 mapper -->
    <select id = "find_id_check" parameterType=
   "memberDTO"
    resultType="String">
        select userId from member
        where email=#{email}
    </select>
    
    <!-- 비밀번호 찾기 관련 mapper -->
    <select id = "find_pass_check" parameterType=
   "memberDTO"
    resultType="String">
        select member_pass from member
        where userId=#{userId} and email=#{email}
    </select>
    
    
    <!-- 소셜 로그인 관련 mapper -->
    <!-- 소셜 로그인 한 후에 회원 인증 버튼을 누르면 소셜 로그인 api에서 받아온 정보를 데이터 베이스의 member테이블에 저장하도록 하는 쿼리 -->
    <insert id="authentication" parameterType="memberDTO">
    insert into cat_user (userId, passwd, email)
    values (#{userId}, 0, #{email})
    </insert>
    
    
    <!-- 비밀번호 변경 관련 mapper -->
    <update id = "pass_change" parameterType="hashMap">
    update cat_user set passwd=#{passwd} where email=#{email}
    </update>
    
    
    <!-- 이메일 중복확인 관련 mapper-->
    <select id = "email_check" resultType="String">
        select email from cat_user
        where email=#{email}
    </select>
    
      
    
    
    <!-- 회원 프로필 확인 mapper -->
    <select id = "member_profile" resultType="memberDTO">
    select userId, email, joindate
    from member
    where userId=#{userId}
    </select>

</mapper>